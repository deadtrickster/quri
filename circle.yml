machine:
  environment:
    PATH: $HOME/.roswell/bin:$PATH
    ROSWELL_BRANCH: master
    ROSWELL_INSTALL_DIR: $HOME/.roswell
    CIRCLE_NODE_LISP_0: ecl
    CIRCLE_NODE_LISP_1: clisp
    CIRCLE_NODE_LISP_2: allegro
    CIRCLE_NODE_LISP_3: cmucl

dependencies:
  override:
    - curl -L https://raw.githubusercontent.com/fukamachi/roswell/debug-ci/scripts/install-for-ci.sh
        | LISP=$(eval echo \$"CIRCLE_NODE_LISP_$CIRCLE_NODE_INDEX") bash
    - ros install prove
    - ros config
  cache_directories:
    - "~/.roswell"
    - "~/.config/common-lisp"

test:
  override:
    - run-prove quri-test.asd: {parallel: true}
